# Title of the rule for easy identification
title: Possible RDP Brute Force - Multiple 4625 From Single IP

# Unique ID for the rule (can follow your org's naming convention)
id: rdp-bruteforce-agg-roninsec-v1

# Rule maturity level: experimental, stable, or deprecated
status: experimental

# Description of what the rule detects and how
description: Flags potential RDP brute force based on repeated failed logons (Event ID 4625) from the same source IP within a short timeframe.

# Specifies the source of logs this rule applies to
logsource:
  product: windows         # Operating system
  service: security        # Windows Security Event Log

# Detection logic block
detection:
  selection:
    EventID: 4625          # Failed logon attempt
    LogonType: 10          # RemoteInteractive (RDP session)
  timeframe: 10m           # Time window to aggregate events (10 minutes)
  condition: count(selection) by IpAddress >= 5  # Trigger if 5+ failed logons from same IP in timeframe

# Fields to include in the output for context and investigation
fields:
  - IpAddress              # Source IP of the logon attempt
  - TargetUserName         # Username that was targeted
  - WorkstationName        # Hostname of the machine being accessed

# Known scenarios that could cause false positives
falsepositives:
  - User mistyping password repeatedly     # Common user behavior
  - Account lockout testing                # Admin or security testing

# Severity level of the alert
level: high

# MITRE ATT&CK technique tags for mapping detection to adversary behavior
tags:
  - attack.t1110           # Brute Force
  - attack.t1021.001       # Remote Services: Remote Desktop Protocol
